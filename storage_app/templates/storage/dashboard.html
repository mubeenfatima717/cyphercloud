{% extends 'base.html' %} 

{% block title %}My Cloud Drive - Dashboard{% endblock %}

{% block content %}
<div class="drive-container">
    <div class="sidebar">
        
        <a href="{% url 'create_folder' %}" class="sidebar-button">➕ New</a> 

    
<p class="sidebar-link">My Folders</p> 
{% for folder in folders %}
    <a href="{% url 'dashboard_folder' folder.id %}" class="sidebar-link {% if current_folder == folder %}active{% endif %}">{{ folder.name }}</a>
{% endfor %}

<!--  LOGOUT BUTTON -->
<a href="{% url 'logout' %}" class="sidebar-link logout-button" onclick="return confirm('Are you sure you want to logout?');">Logout</a>


</div>

    <div class="main-content">
        
        <div class="action-bar">
            <h2>My Files</h2>
          <form action="{% url 'upload_file' %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- This is the new, smart part. It's a hidden field. -->
    {% if current_folder %}
        <input type="hidden" name="folder_id" value="{{ current_folder.id }}">
    {% endif %}

    <input type="file" name="file_input" id="file_input" style="display: none;" onchange="this.form.submit();" required>
    <label for="file_input" class="upload-button">➕ Upload File</label>
</form>
        </div>
        
        <table class="file-list-table">
            <thead>
                <tr>
                    <th>Filename</th>
                    <th class="align-center">File Type</th>
                    <th class="align-center">Size</th>
                    <th class="align-right">Actions</th>
                </tr>
            </thead>
            <tbody>
    {% for file in files %}
    <tr>
        <!-- Field: file_name -->
        <td>{{ file.file_name }}</td>
        
        <!-- Field: file_type -->
        <td class="align-center">{{ file.file_type }}</td>
        

        <td class="align-center">{{ file.file_size|filesizeformat }}</td>
        
       <td class="align-right">
    
    <a href="{% url 'download_file' file.id %}">Download</a> 
    |<a href="{% url 'delete_file' file.id %}" style="color:red;">Delete</a>
   
</td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="4" style="text-align:center;">No files found. Upload one!</td>
    </tr>
    {% endfor %}
</tbody>
        </table>
    </div>
</div>
<style>
    .sidebar-link.active {
        background-color: #e0f2ff !important; /* Light blue background */
        color: #0077c2 !important;           /* Blue text */
        font-weight: 700 !important;          /* Bold text */
    }
</style>
{% endblock %}